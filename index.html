<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Para Çuvalı və Google Giriş</title>
<style>
:root{
  --bg1:#0f0c29;
  --bg2:#302b63;
  --bg3:#24243e;
  --card:rgba(255,255,255,0.06);
  --glass:rgba(255,255,255,0.12);
  --text:#f8fafc;
  --accent:#22c55e;
}
*{box-sizing:border-box;margin:0;padding:0;}
html,body{height:100%;}
body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,'Helvetica Neue',Arial,'Apple Color Emoji','Segoe UI Emoji';
  color:var(--text);
  background:linear-gradient(135deg,var(--bg1),var(--bg2) 50%,var(--bg3));
  display:grid;
  place-items:center;
  overflow:hidden;
  opacity:0; /* fade-in */
  transition: opacity 1s ease;
}
.wrap{display:grid;place-items:center;gap:12px;text-align:center;padding:20px;}
.user-info{font-size:1rem;font-weight:600;opacity:.9;margin-bottom:6px;transform:translateY(20px);opacity:0;transition: transform 0.8s ease, opacity 0.8s ease;}
.card{
  position:relative;
  width:min(60vw,320px);
  aspect-ratio:1/1;
  display:grid;
  place-items:center;
  background: radial-gradient(60% 60% at 50% 30%,var(--glass),transparent 70%),var(--card);
  border:1px solid rgba(255,255,255,0.14);
  border-radius:24px;
  box-shadow:0 15px 40px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.08);
  backdrop-filter:blur(6px);
  transform: scale(0.5);
  opacity:0;
  transition: transform 0.8s ease, opacity 0.8s ease;
}
.bag{font-size:clamp(5rem,18vw,12rem);filter:drop-shadow(0 8px 15px rgba(0,0,0,0.35));user-select:none;animation:float 5s ease-in-out infinite;}
.balance{margin-top:10px;display:grid;place-items:center;font-weight:700;letter-spacing:1px;text-shadow:0 2px 5px rgba(0,0,0,0.5);}
.balance .symbol{font-size:clamp(1rem,2.5vw,1.5rem);opacity:.9;margin-right:4px;}
.balance .value{font-size:clamp(1.5rem,5vw,2.5rem);line-height:1;}
.google-btn{
  margin-top:14px;
  padding:8px 16px;
  font-size:0.95rem;
  background:#4285F4;
  color:white;
  border:none;
  border-radius:8px;
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:6px;
  font-weight:600;
  opacity:0;
  transform:translateY(10px);
  transition: transform 0.6s ease, opacity 0.6s ease;
}
.google-btn img{width:18px;height:18px;}
.glow{position:absolute;inset:-30%;pointer-events:none;background:radial-gradient(40% 35% at 50% 10%, rgba(34,197,94,.25), transparent 60%),radial-gradient(30% 30% at 80% 70%, rgba(99,102,241,.18), transparent 60%);filter:blur(30px);}
#confettiContainer{position:fixed;top:0;left:0;width:100%;height:0;pointer-events:none;overflow:visible;}
@keyframes float{0%,100%{transform:translateY(0);}50%{transform:translateY(-5px);}}
#payBtn, #cekBtn {
  position:fixed;
  right:20px;
  padding:10px 20px;
  font-size:1rem;
  color:white;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:600;
  opacity:0;
  transform:translateY(10px);
  transition: transform 0.6s ease, opacity 0.6s ease;
}
#payBtn{top:20px; background:#22c55e;}
#cekBtn{top:64px; background:#2563eb;}
#uploadInput{display:none;}
/* Modal */
#cekModal, #payModal{
  position:fixed; inset:0; display:none; justify-content:center; align-items:center;
  background:rgba(0,0,0,0.6); z-index:9999;
}
.modal-content{
  background:linear-gradient(135deg,var(--bg1),var(--bg2) 50%,var(--bg3));
  padding:20px; border-radius:12px; color:white; text-align:center;
}
.modal-content button{margin-top:12px;background:#22c55e;color:white;padding:10px 20px;border:none;border-radius:8px;cursor:pointer;}
</style>
</head>
<body>
<div class="wrap">
<div id="userInfo" class="user-info"></div>
<div class="card">
  <div class="glow"></div>
  <div class="bag">💰</div>
  <div class="balance"><span class="symbol">AZN</span><span id="balance" class="value">0.00</span></div>
</div>
<button class="google-btn" id="loginBtn"><img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg" alt="G"> Google ilə Giriş</button>
</div>

<div id="confettiContainer"></div>
<button id="payBtn">💲 PUL YÜKLƏ</button>
<button id="cekBtn">📷 ÇEK</button>
<input id="uploadInput" type="file" accept="image/*" capture="environment">

<!-- Modal -->
<div id="cekModal"><div class="modal-content"><p>ÇƏKİN ŞƏKLİ Nİ GÖNDƏRMƏYƏ BAS</p><button id="cekSendBtn">ÇEKİ GÖNDƏRİRƏM</button></div></div>
<div id="payModal"><div class="modal-content"><p>💲 PUL YÜKLƏ</p><button id="payConfirmBtn">TƏSDİQ ET</button></div></div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-storage-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyC4sGTK_P4KperVswrxxmt69H5cocsgnNw",
  authDomain: "niceuc-e5986.firebaseapp.com",
  databaseURL: "https://niceuc-e5986-default-rtdb.firebaseio.com",
  projectId: "niceuc-e5986",
  storageBucket: "niceuc-e5986.firebasestorage.app",
  messagingSenderId: "242221260650",
  appId: "1:242221260650:web:d140153a2167c4738dcf13",
  measurementId: "G-YKKRHJKYNB"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth(), db=firebase.database(), storage=firebase.storage();
let oldBalance=0;

// Giriş animasiyası
window.addEventListener('load', ()=>{
  document.body.style.opacity=1;
  setTimeout(()=>{document.querySelector('.card').style.transform='scale(1)';document.querySelector('.card').style.opacity=1;},300);
  setTimeout(()=>{const u=document.querySelector('.user-info'); u.style.transform='translateY(0)'; u.style.opacity=1;},600);
  setTimeout(()=>{['.google-btn','#payBtn','#cekBtn'].forEach(sel=>{const e=document.querySelector(sel); e.style.opacity=1; e.style.transform='translateY(0)';});},900);
});

// Google login
document.getElementById('loginBtn').addEventListener('click', ()=>{
  const provider=new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider).then(res=>saveUser(res.user)).catch(err=>alert(err.message));
});

function saveUser(user){
  document.getElementById('userInfo').textContent=`Salam, ${user.displayName} (${user.email})`;
  db.ref('balances/'+user.uid).on('value', snap=>{
    const balance = snap.val()||0;
    document.getElementById('balance').textContent=parseFloat(balance).toFixed(2);
    if(balance>oldBalance) launchConfetti();
    oldBalance=balance;
  });
}

auth.onAuthStateChanged(user=>{if(user) saveUser(user);});

// Pul yüklə
const payBtn=document.getElementById('payBtn');
const payModal=document.getElementById('payModal');
const payConfirmBtn=document.getElementById('payConfirmBtn');
payBtn.addEventListener('click',()=>{payModal.style.display='flex';});
payConfirmBtn.addEventListener('click',()=>{alert('M10 077 543 50 53 ÖDƏNİŞ ET'); payModal.style.display='none';});

// ÇEK
const cekBtn=document.getElementById('cekBtn');
const cekModal=document.getElementById('cekModal');
const cekSendBtn=document.getElementById('cekSendBtn');
const uploadInput=document.getElementById('uploadInput');

cekBtn.addEventListener('click',()=>{cekModal.style.display='flex';});
cekSendBtn.addEventListener('click',()=>{
  uploadInput.click();
  cekModal.style.display='none';
});

uploadInput.addEventListener('change', async (e)=>{
  const file=e.target.files[0];
  if(!file){return;}
  const user=auth.currentUser;
  if(!user){alert('Əvvəlcə Google ilə daxil olun.'); uploadInput.value=''; return;}
  try{
    const ts=Date.now(), ext=(file.name.split('.').pop()||'jpg').toLowerCase();
    const path=`receipts/${user.uid}/${ts}.${ext}`;
    const snap=await storage.ref(path).put(file);
    const url=await snap.ref.getDownloadURL();
    await db.ref('receipts').push({uid:user.uid,name:user.displayName,email:user.email,url,createdAt:firebase.database.ServerValue.TIMESTAMP});
    // WhatsApp link
    const waNumber='+9945132329857';
    const waMsg='ÇEKİ GÖNDƏRİRƏM';
    window.open(`https://wa.me/${waNumber}?text=${encodeURIComponent(waMsg)}`);
    alert('Şəkil göndərildi ✅ WhatsApp açıldı.');
  }catch(err){console.error(err); alert('Xəta: '+err.message);}
  finally{uploadInput.value='';}
});

// Konfetti
function launchConfetti(){
  const container=document.getElementById('confettiContainer');
  for(let i=0;i<50;i++){
    const conf=document.createElement('div');
    conf.textContent='🎊';
    conf.style.position='absolute';
    conf.style.fontSize=Math.random()*24+16+'px';
    conf.style.left=Math.random()*100+'%';
    conf.style.top='-5%';
    conf.style.opacity=Math.random();
    conf.style.transition='transform 5s linear, opacity 5s';
    container.appendChild(conf);
    const delay=Math.random()*1000;
    setTimeout(()=>{conf.style.transform=`translateY(${window.innerHeight}px) rotate(${Math.random()*360}deg)`; conf.style.opacity=0;}, delay);
    setTimeout(()=>container.removeChild(conf),5100);
  }
}
</script>
</body>
</html>
