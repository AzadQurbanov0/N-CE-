<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Müştəri Paneli</title>
<style>
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,'Helvetica Neue',Arial;
  background: linear-gradient(90deg, #d60000, #000);
  color:#fff;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:100vh;
}
#loginBtn{
  padding:10px 18px;
  font-size:1rem;
  background:#4285F4;
  color:white;
  border:none;
  border-radius:6px;
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:8px;
  font-weight:600;
}
#loginBtn img{width:20px;height:20px;}
#userInfo{margin-bottom:16px;font-weight:600;font-size:1.2rem;}
#balance{margin-top:10px;font-size:2rem;font-weight:bold;}
</style>
</head>
<body>

<div id="userInfo"></div>
<button id="loginBtn"><img src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg"> Gmail ilə Giriş</button>
<div id="balance"></div>

<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.14.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyC4sGTK_P4KperVswrxxmt69H5cocsgnNw",
  authDomain: "niceuc-e5986.firebaseapp.com",
  databaseURL: "https://niceuc-e5986-default-rtdb.firebaseio.com",
  projectId: "niceuc-e5986",
  storageBucket: "niceuc-e5986.firebasestorage.app",
  messagingSenderId: "242221260650",
  appId: "1:242221260650:web:d140153a2167c4738dcf13",
  measurementId: "G-YKKRHJKYNB"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

const loginBtn = document.getElementById('loginBtn');
const userInfoDiv = document.getElementById('userInfo');
const balanceDiv = document.getElementById('balance');

loginBtn.addEventListener('click', () => {
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider)
    .then(res => {
      const user = res.user;
      userInfoDiv.textContent = `Salam, ${user.displayName}`;
      loginBtn.style.display='none';
      const userRef = db.ref('users/' + user.uid);
      userRef.set({name:user.displayName,email:user.email});
      listenBalance(user.uid);
    })
    .catch(err => alert(err.message));
});

function listenBalance(uid){
  const balanceRef = db.ref('balances/' + uid);
  balanceRef.on('value', snap => {
    const val = snap.val() || 0;
    balanceDiv.textContent = `${parseFloat(val).toFixed(2)} AZN`;
  });
}
</script>
</body>
</html>
