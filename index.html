<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <title>I N C I | Admin Paneli</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f1f5f9; padding: 20px; color: #1e293b; }
        .container { max-width: 800px; margin: auto; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 25px; }
        .stat-card { background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.05); border-bottom: 4px solid #2563eb; }
        .stat-card div { font-size: 22px; font-weight: bold; color: #2563eb; margin-top: 8px; }
        .box { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        input, textarea, select { width: 100%; padding: 12px; margin-bottom: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { background: #2563eb; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; }
        .order-card { background: white; padding: 18px; border-left: 6px solid #2563eb; margin-bottom: 12px; border-radius: 8px; border: 1px solid #e2e8f0; }
        .item-list { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; align-items: center; }
        .red { background: #ef4444; color: white; padding: 6px 12px; border-radius: 5px; border: none; cursor: pointer; }
        .time-tag { color: #64748b; font-size: 12px; display: block; margin-top: 5px; font-weight: bold; }
        .badge-info { background: #e0e7ff; color: #4338ca; padding: 2px 6px; border-radius: 4px; font-size: 11px; margin-left: 5px; }
    </style>
</head>
<body>

<div class="container">
    <h2>I N C I Admin Paneli</h2>
    
    <div class="stats-grid">
        <div class="stat-card"><h4>Sifari≈ü</h4><div id="statCount">0</div></div>
        <div class="stat-card" style="border-color: #10b981;"><h4>Qazanc</h4><div id="statSum">0 AZN</div></div>
        <div class="stat-card" style="border-color: #f59e0b;"><h4>M…ôhsul</h4><div id="statProd">0</div></div>
    </div>

    <div class="box">
        <h3>Yeni M…ôhsul ∆èlav…ô Et</h3>
        <input id="pName" placeholder="M…ôhsulun adƒ±">
        <input id="pPrice" type="number" placeholder="Qiym…ôti (AZN)">
        <input id="pImg" placeholder="≈û…ôkil URL">
        
        <select id="pCategory">
            <option value="Pasta">Pastalar</option>
            <option value="Ayaqqabƒ±">Ayaqqabƒ±lar</option>
            <option value="Geyim">Geyiml…ôr</option>
            <option value="Dig…ôr">Dig…ôr</option>
        </select>

        <select id="pTag">
            <option value="">Etiket yoxdur</option>
            <option value="Yeni">Yeni</option>
            <option value="Endirim">Endirim</option>
            <option value="Bitib">Stokda yoxdur</option>
        </select>

        <textarea id="pDesc" placeholder="M…ôlumat"></textarea>
        <button id="addBtn">Yadda Saxla</button>
    </div>

    <div class="box"><h3>Sifari≈ül…ôr</h3><div id="adminOrders"></div></div>
    <div class="box"><h3>M…ôhsullar</h3><div id="adminProductList"></div></div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBykQbnz828fnJSYpaWZb9lVMt76y5uYp8",
        authDomain: "azad042-65afa.firebaseapp.com",
        databaseURL: "https://azad042-65afa-default-rtdb.firebaseio.com",
        projectId: "azad042-65afa",
        storageBucket: "azad042-65afa.firebasestorage.app",
        messagingSenderId: "568634268703",
        appId: "1:568634268703:web:3c3dd14a071b0ffe73492a"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    document.getElementById("addBtn").onclick = function() {
        const name = document.getElementById("pName").value;
        const price = document.getElementById("pPrice").value;
        const img = document.getElementById("pImg").value;
        const cat = document.getElementById("pCategory").value;
        const tag = document.getElementById("pTag").value;
        const desc = document.getElementById("pDesc").value;

        if(!name || !price) return alert("Ad v…ô qiym…ôt yazƒ±n!");
        db.ref('products').push({ name, price, img, category: cat, tag: tag, desc });
        alert("∆èlav…ô edildi!");
        location.reload();
    };

    db.ref('products').on('value', snap => {
        let products = snap.val();
        let html = ""; let count = 0;
        for(let id in products) {
            count++;
            let p = products[id];
            html += `<div class="item-list">
                <span><b>${p.name}</b> <small>${p.tag ? '['+p.tag+']' : ''}</small> - ${p.price} AZN</span>
                <button class="red" onclick="deleteProduct('${id}')">Sil</button>
            </div>`;
        }
        document.getElementById("adminProductList").innerHTML = html;
        document.getElementById("statProd").innerText = count;
    });

    db.ref('orders').on('value', snap => {
        let orders = snap.val();
        let html = ""; let total = 0; let count = 0;
        for(let id in orders) {
            count++;
            let o = orders[id];
            total += parseFloat(o.total || 0);
            html += `<div class="order-card">
                <div style="display:flex; justify-content:space-between;"><b>#${o.id}</b> <b>${o.total}</b></div>
                <small>üë§ ${o.customer} (${o.phone})</small><br>
                <small>üìç ${o.address}</small><br>
                <small>üì¶ ${o.items}</small><br>
                <span class="time-tag">üïí Tarix: ${o.time || 'Qeyd olunmayƒ±b'}</span>
                <div style="margin-top:10px;">
                    <select onchange="updateStatus('${id}', this.value)" style="width:120px; padding:4px;">
                        <option value="">Status</option>
                        <option value="Hazƒ±rlanƒ±r">Hazƒ±rlanƒ±r</option>
                        <option value="T…ôhvil verildi">T…ôhvil verildi</option>
                    </select>
                    <button class="red" onclick="deleteOrder('${id}')">Sil</button>
                </div>
            </div>`;
        }
        document.getElementById("adminOrders").innerHTML = html;
        document.getElementById("statCount").innerText = count;
        document.getElementById("statSum").innerText = total.toFixed(2) + " AZN";
    });

    window.deleteProduct = id => db.ref('products/' + id).remove();
    window.deleteOrder = id => db.ref('orders/' + id).remove();
    window.updateStatus = (id, st) => db.ref('orders/' + id).update({status: st});
</script>
</body>
</html>
