<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <title>I N C I | Admin</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f1f5f9; padding: 20px; color: #1e293b; }
        .container { max-width: 800px; margin: auto; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 25px; }
        .stat-card { background: white; padding: 20px; border-radius: 12px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.05); border-bottom: 4px solid #2563eb; }
        .stat-card h4 { margin: 0; color: #64748b; font-size: 13px; text-transform: uppercase; }
        .stat-card div { font-size: 22px; font-weight: bold; color: #2563eb; margin-top: 8px; }
        
        .box { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        input, textarea, select { width: 100%; padding: 12px; margin-bottom: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        button { background: #2563eb; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; transition: 0.3s; }
        button:hover { background: #1d4ed8; }
        
        .order-card { background: white; padding: 18px; border-left: 6px solid #2563eb; margin-bottom: 12px; border-radius: 8px; border: 1px solid #e2e8f0; }
        .red { background: #ef4444; width: auto; margin-top: 8px; padding: 6px 12px; font-size: 12px; }
        .item-list { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; align-items: center; }
    </style>
</head>
<body>

<div class="container">
    <h2>I N C I Admin Paneli</h2>

    <div class="stats-grid">
        <div class="stat-card">
            <h4>Toplam Sifari≈ü</h4>
            <div id="statCount">0</div>
        </div>
        <div class="stat-card" style="border-color: #10b981;">
            <h4>√úmumi Qazanc</h4>
            <div id="statSum">0 AZN</div>
        </div>
        <div class="stat-card" style="border-color: #f59e0b;">
            <h4>M…ôhsul Sayƒ±</h4>
            <div id="statProd">0</div>
        </div>
    </div>

    <div class="box">
        <h3>Yeni M…ôhsul ∆èlav…ô Et</h3>
        <input id="pName" placeholder="M…ôhsulun adƒ±">
        <input id="pPrice" placeholder="Qiym…ôti (AZN)">
        <input id="pImg" placeholder="≈û…ôkil URL (link)">
        <textarea id="pDesc" placeholder="M…ôhsul haqqƒ±nda qƒ±sa m…ôlumat"></textarea>
        <button onclick="addProduct()">Yadda saxla</button>
    </div>

    <div class="box">
        <h3>Sifari≈ül…ôrin ƒ∞dar…ô Edilm…ôsi</h3>
        <div id="adminOrders"></div>
    </div>

    <div class="box">
        <h3>Bazadakƒ± M…ôhsullar</h3>
        <div id="adminProductList"></div>
    </div>
</div>

<script>
    function addProduct() {
        const name = document.getElementById("pName").value;
        const price = document.getElementById("pPrice").value;
        const img = document.getElementById("pImg").value;
        const desc = document.getElementById("pDesc").value;
        if(!name || !price) return alert("Ad v…ô qiym…ôt m√ºtl…ôqdir!");

        let products = JSON.parse(localStorage.getItem("products")) || [];
        products.push({ id: Date.now(), name, price, img, desc });
        localStorage.setItem("products", JSON.stringify(products));
        location.reload();
    }

    function renderStats() {
        let orders = JSON.parse(localStorage.getItem("orders")) || [];
        let prods = JSON.parse(localStorage.getItem("products")) || [];
        let totalSum = orders.reduce((a, b) => a + parseFloat(b.total || 0), 0);
        
        document.getElementById("statCount").innerText = orders.length;
        document.getElementById("statSum").innerText = totalSum.toFixed(2) + " AZN";
        document.getElementById("statProd").innerText = prods.length;
    }

    function renderAdminProducts() {
        let products = JSON.parse(localStorage.getItem("products")) || [];
        document.getElementById("adminProductList").innerHTML = products.map(p => `
            <div class="item-list">
                <span><b>${p.name}</b> - ${p.price} AZN</span>
                <button class="red" onclick="deleteProduct(${p.id})">Sil</button>
            </div>`).join('');
    }

    function deleteProduct(id) {
        if(confirm("Bu m…ôhsulu silm…ôk ist…ôyirsiz?")) {
            let products = JSON.parse(localStorage.getItem("products")) || [];
            products = products.filter(p => p.id != id);
            localStorage.setItem("products", JSON.stringify(products));
            location.reload();
        }
    }

    function renderOrders() {
        let orders = JSON.parse(localStorage.getItem("orders")) || [];
        const container = document.getElementById("adminOrders");
        if(orders.length === 0) { container.innerHTML = "Sifari≈ü yoxdur."; return; }

        container.innerHTML = orders.reverse().map(o => `
            <div class="order-card">
                <div style="display:flex; justify-content:space-between;">
                    <b>Sifari≈ü #${o.id}</b> 
                    <span style="color:#10b981; font-weight:bold;">${o.total}</span>
                </div>
                <div style="font-size:14px; margin-top:10px;">
                    üë§ <b>${o.customer}</b> (${o.phone})<br>
                    üìç √únvan: ${o.address}<br>
                    üì¶ M…ôhsullar: ${o.items ? o.items.join(", ") : 'M…ôlumat yoxdur'}<br>
                    üïí Status: <span style="color:#2563eb; font-weight:bold;">${o.status}</span>
                </div>
                <select style="margin-top:10px;" onchange="updateStatus(${o.id}, this.value)">
                    <option value="">Statusu D…ôyi≈ü</option>
                    <option value="Sifari≈ü verildi">Sifari≈ü verildi</option>
                    <option value="Hazƒ±rlanƒ±r">Hazƒ±rlanƒ±r</option>
                    <option value="Kuryer…ô verildi">Kuryer…ô verildi</option>
                    <option value="T…ôhvil verildi">T…ôhvil verildi</option>
                </select>
                <button class="red" onclick="deleteOrder(${o.id})">Sifari≈üi Sil</button>
            </div>`).join('');
        renderStats();
    }

    function updateStatus(id, stat) {
        if(!stat) return;
        let orders = JSON.parse(localStorage.getItem("orders")) || [];
        let idx = orders.findIndex(o => o.id == id);
        if(idx !== -1) {
            orders[idx].status = stat;
            localStorage.setItem("orders", JSON.stringify(orders));
            renderOrders();
        }
    }

    function deleteOrder(id) {
        if(confirm("Sifari≈üi silm…ôk ist…ôyirsiz?")) {
            let orders = JSON.parse(localStorage.getItem("orders")) || [];
            orders = orders.filter(o => o.id != id);
            localStorage.setItem("orders", JSON.stringify(orders));
            renderOrders();
        }
    }

    renderAdminProducts();
    renderOrders();
</script>
</body>
</html>
